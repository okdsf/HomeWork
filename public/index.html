<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n-key="page.title">Farm Store Dashboard</title>
    <link rel="stylesheet" href="style.css">
    <!-- Flatpickr for internationalized date picker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/fr.js"></script>
</head>

<body>
    <header>
        <h1 data-i18n-key="header.title">Farm Store Dashboard</h1>
        <button id="show-er-diagram-btn" class="er-btn" data-i18n-key="er_diagram.button">View ER Diagram</button>
        <div class="language-switcher">
            <button id="lang-en" class="lang-btn active">English</button>
            <button id="lang-zh" class="lang-btn">‰∏≠Êñá</button>
            <button id="lang-fr" class="lang-btn">Fran√ßais</button>
        </div>
    </header>

    <main class="dashboard-container">
        <!-- Â∑¶Ê†èÔºöÊï∞ÊçÆÁÆ°ÁêÜ -->
        <div class="column" id="management-column">

            <!-- Âç°Áâá‰∏ÄÔºö‰∫ßÂìÅ‰∏éÂ∫ìÂ≠ò -->
            <div class="card">
                <h2 data-i18n-key="product_management.title">üóÇÔ∏è Products & Stock Management</h2>
                <table id="product-table">
                    <thead>
                        <tr>
                            <th data-i18n-key="product_table.headers.name">Product Name</th>
                            <th data-i18n-key="product_table.headers.price">Price (HT)</th>
                            <th data-i18n-key="product_table.headers.stock">Stock</th>
                            <th data-i18n-key="product_table.headers.actions">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="product-table-body">
                        <!-- ‰∫ßÂìÅÊï∞ÊçÆÂ∞ÜÁî±JSÂä®ÊÄÅÂ°´ÂÖÖ -->
                    </tbody>
                </table>
                <details class="add-section">
                    <summary data-i18n-key="product_management.add_section.summary">‚ñ∫ Click to add a new product
                    </summary>
                    <form id="add-product-form" class="add-form">
                        <input type="text" id="new-product-name"
                            data-i18n-placeholder="product_management.form.name_placeholder" placeholder="Product Name"
                            required>
                        <input type="number" id="new-product-price"
                            data-i18n-placeholder="product_management.form.price_placeholder" placeholder="Price (HT)"
                            step="0.01" required>
                        <input type="number" id="new-product-stock"
                            data-i18n-placeholder="product_management.form.stock_placeholder"
                            placeholder="Initial Stock" required>
                        <button type="submit" data-i18n-key="product_management.form.submit_button">Confirm Add</button>
                    </form>
                </details>
            </div>

            <!-- Âç°Áâá‰∫åÔºöÂø†ÂÆûÂÆ¢Êà∑ -->
            <div class="card">
                <h2 data-i18n-key="customer_management.title">üë• Loyal Customer Management</h2>
                <ul id="customer-list">
                    <!-- ÂÆ¢Êà∑ÂàóË°®Â∞ÜÁî±JSÂä®ÊÄÅÂ°´ÂÖÖ -->
                </ul>
                <form id="add-customer-form" class="add-section add-form">
                    <input type="text" id="new-customer-firstname"
                        data-i18n-placeholder="customer_management.form.firstname_placeholder" placeholder="First Name"
                        required>
                    <input type="text" id="new-customer-lastname"
                        data-i18n-placeholder="customer_management.form.lastname_placeholder" placeholder="Last Name"
                        required>
                    <select id="new-customer-gender" required class="styled-select">
                        <option value="Male" data-i18n-key="customer_management.gender.male">Male</option>
                        <option value="Female" data-i18n-key="customer_management.gender.female">Female</option>
                    </select>
                    <button type="submit" data-i18n-key="customer_management.form.submit_button">Add Customer</button>
                </form>
            </div>
        </div>

        <!-- Âè≥Ê†èÔºöÊó•Â∏∏Êìç‰Ωú -->
        <div class="column" id="operations-column">

            <!-- Âç°Áâá‰∏âÔºöÈîÄÂîÆÂΩïÂÖ• -->
            <div class="card">
                <h2 data-i18n-key="sales_entry.title">üõí Record a Sale</h2>
                <form id="record-sale-form">
                    <div class="form-group">
                        <label for="sale-product" data-i18n-key="sales_entry.form.product_label">Product:</label>
                        <select id="sale-product" required class="styled-select"></select>
                    </div>
                    <div class="form-group">
                        <label for="sale-quantity" data-i18n-key="sales_entry.form.quantity_label">Quantity:</label>
                        <input type="number" id="sale-quantity" value="1" min="1" required>
                    </div>
                    <button type="button" id="add-to-cart-btn" data-i18n-key="sales_entry.form.add_to_cart_button">Add
                        to List</button>

                    <h3 class="cart-title" data-i18n-key="sales_entry.cart_title">Current Sale List</h3>
                    <ul id="sale-cart">
                        <!-- Ë¥≠Áâ©ËΩ¶È°πÁõÆÂ∞ÜÁî±JSÂä®ÊÄÅÊ∑ªÂä† -->
                    </ul>

                    <hr>

                    <div class="form-group">
                        <label for="sale-customer" data-i18n-key="sales_entry.form.customer_label">Customer
                            (Optional):</label>
                        <select id="sale-customer" class="styled-select">
                            <option value="" data-i18n-key="sales_entry.form.walk_in_customer">‚Äî Walk-in Customer ‚Äî
                            </option>
                        </select>
                    </div>

                    <h3 id="total-price" data-i18n-key="sales_entry.total_price">Total: ‚Ç¨0.00</h3>
                    <button type="submit" id="confirm-sale-btn" data-i18n-key="sales_entry.form.confirm_sale_button">‚úì
                        Confirm Sale</button>
                </form>
            </div>

            <!-- Âç°ÁâáÂõõÔºöÈîÄÂîÆÂéÜÂè≤ËÆ∞ÂΩï -->
            <div class="card">
                <h2 data-i18n-key="sales_history.title">üìú Recent Sales History</h2>
                <div id="sales-history-list">
                    <!-- ÈîÄÂîÆÂéÜÂè≤Â∞ÜÊòæÁ§∫Âú®ËøôÈáå -->
                </div>
            </div>

            <!-- Âç°Áâá‰∫îÔºöÈîÄÂîÆ‰∏öÁª©ÈÄüËßà -->
            <div class="card">
                <h2 data-i18n-key="sales_report.title">üìä Sales Snapshot</h2>
                <div id="sales-report">
                    <div class="form-group">
                        <label for="start-date" data-i18n-key="sales_report.form.start_date_label">Start Date:</label>
                        <input type="date" id="start-date">
                    </div>
                    <div class="form-group">
                        <label for="end-date" data-i18n-key="sales_report.form.end_date_label">End Date:</label>
                        <input type="date" id="end-date">
                    </div>
                    <button id="generate-report-btn" data-i18n-key="sales_report.form.generate_button">Query</button>
                    <div id="report-result">
                        <!-- Êä•ÂëäÁªìÊûúÂ∞ÜÊòæÁ§∫Âú®ËøôÈáå -->
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- ÁºñËæëÂÆ¢Êà∑Ê®°ÊÄÅÊ°Ü -->
    <div id="edit-customer-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="close-edit-modal">&times;</span>
            <h3 data-i18n-key="customer_management.edit_title">Edit Customer</h3>
            <form id="edit-customer-form">
                <input type="hidden" id="edit-customer-id">
                <input type="text" id="edit-customer-firstname"
                    data-i18n-placeholder="customer_management.form.firstname_placeholder" placeholder="First Name"
                    required>
                <input type="text" id="edit-customer-lastname"
                    data-i18n-placeholder="customer_management.form.lastname_placeholder" placeholder="Last Name"
                    required>
                <select id="edit-customer-gender" required class="styled-select">
                    <option value="Male" data-i18n-key="customer_management.gender.male">Male</option>
                    <option value="Female" data-i18n-key="customer_management.gender.female">Female</option>
                </select>
                <button type="submit" data-i18n-key="customer_management.form.save_button">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- ERÂõæÊ®°ÊÄÅÊ°Ü -->
    <div id="er-diagram-modal" class="modal">
        <div class="modal-content er-modal-content">
            <span class="modal-close" id="close-er-modal">&times;</span>
            <h3 data-i18n-key="er_diagram.title">Entity-Relationship Diagram</h3>
            <div id="er-diagram-container">
                <svg viewBox="0 0 800 520" xmlns="http://www.w3.org/2000/svg" style="max-width: 100%; height: auto;">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#6EC1E4"/>
                        </marker>
                        <marker id="crow-foot" markerWidth="12" markerHeight="12" refX="0" refY="6" orient="auto">
                            <path d="M0,6 L12,0 M0,6 L12,6 M0,6 L12,12" stroke="#6EC1E4" stroke-width="2" fill="none"/>
                        </marker>
                        <linearGradient id="headerGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#6EC1E4"/>
                            <stop offset="100%" style="stop-color:#4A90E2"/>
                        </linearGradient>
                    </defs>

                    <!-- Products Table -->
                    <g transform="translate(30, 20)">
                        <rect x="0" y="0" width="170" height="150" rx="8" fill="white" stroke="#6EC1E4" stroke-width="2"/>
                        <rect x="0" y="0" width="170" height="32" rx="8" fill="url(#headerGrad)"/>
                        <rect x="0" y="24" width="170" height="8" fill="url(#headerGrad)"/>
                        <text x="85" y="22" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Products</text>
                        <text x="10" y="52" font-size="11" fill="#2C3E50"><tspan fill="#51CF66" font-weight="bold">PK</tspan> product_id INT</text>
                        <text x="10" y="72" font-size="11" fill="#2C3E50">name VARCHAR</text>
                        <text x="10" y="92" font-size="11" fill="#2C3E50">unit_price_ht DECIMAL</text>
                        <text x="10" y="112" font-size="11" fill="#2C3E50">vat_rate DECIMAL</text>
                        <text x="10" y="132" font-size="11" fill="#2C3E50">stock_quantity INT</text>
                    </g>

                    <!-- Customers Table -->
                    <g transform="translate(30, 280)">
                        <rect x="0" y="0" width="170" height="130" rx="8" fill="white" stroke="#6EC1E4" stroke-width="2"/>
                        <rect x="0" y="0" width="170" height="32" rx="8" fill="url(#headerGrad)"/>
                        <rect x="0" y="24" width="170" height="8" fill="url(#headerGrad)"/>
                        <text x="85" y="22" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Customers</text>
                        <text x="10" y="52" font-size="11" fill="#2C3E50"><tspan fill="#51CF66" font-weight="bold">PK</tspan> customer_id INT</text>
                        <text x="10" y="72" font-size="11" fill="#2C3E50">first_name VARCHAR</text>
                        <text x="10" y="92" font-size="11" fill="#2C3E50">last_name VARCHAR</text>
                        <text x="10" y="112" font-size="11" fill="#2C3E50">gender ENUM</text>
                    </g>

                    <!-- Sales Table -->
                    <g transform="translate(315, 280)">
                        <rect x="0" y="0" width="170" height="110" rx="8" fill="white" stroke="#6EC1E4" stroke-width="2"/>
                        <rect x="0" y="0" width="170" height="32" rx="8" fill="url(#headerGrad)"/>
                        <rect x="0" y="24" width="170" height="8" fill="url(#headerGrad)"/>
                        <text x="85" y="22" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Sales</text>
                        <text x="10" y="52" font-size="11" fill="#2C3E50"><tspan fill="#51CF66" font-weight="bold">PK</tspan> sale_id INT</text>
                        <text x="10" y="72" font-size="11" fill="#2C3E50">sale_date DATETIME</text>
                        <text x="10" y="92" font-size="11" fill="#2C3E50"><tspan fill="#6EC1E4" font-weight="bold">FK</tspan> customer_id INT</text>
                    </g>

                    <!-- Sale_Items Table -->
                    <g transform="translate(600, 140)">
                        <rect x="0" y="0" width="170" height="170" rx="8" fill="white" stroke="#6EC1E4" stroke-width="2"/>
                        <rect x="0" y="0" width="170" height="32" rx="8" fill="url(#headerGrad)"/>
                        <rect x="0" y="24" width="170" height="8" fill="url(#headerGrad)"/>
                        <text x="85" y="22" text-anchor="middle" fill="white" font-weight="bold" font-size="14">Sale_Items</text>
                        <text x="10" y="52" font-size="11" fill="#2C3E50"><tspan fill="#51CF66" font-weight="bold">PK</tspan> sale_item_id INT</text>
                        <text x="10" y="72" font-size="11" fill="#2C3E50"><tspan fill="#6EC1E4" font-weight="bold">FK</tspan> sale_id INT</text>
                        <text x="10" y="92" font-size="11" fill="#2C3E50"><tspan fill="#6EC1E4" font-weight="bold">FK</tspan> product_id INT</text>
                        <text x="10" y="112" font-size="11" fill="#2C3E50">quantity_sold INT</text>
                        <text x="10" y="132" font-size="11" fill="#2C3E50">price_at_sale DECIMAL</text>
                        <text x="10" y="152" font-size="11" fill="#2C3E50">vat_at_sale DECIMAL</text>
                    </g>

                    <!-- Relationship Lines -->
                    <!-- Customers -> Sales (1:N) -->
                    <line x1="200" y1="345" x2="315" y2="345" stroke="#95D475" stroke-width="2"/>
                    <circle cx="200" cy="345" r="4" fill="#95D475"/>
                    <text x="208" y="342" font-size="10" fill="#95D475">1</text>
                    <text x="295" y="342" font-size="10" fill="#95D475">N</text>
                    <path d="M305,340 L315,345 L305,350" stroke="#95D475" stroke-width="2" fill="none"/>
                    <text x="245" y="335" font-size="9" fill="#7F8C8D" font-style="italic">places</text>

                    <!-- Sales -> Sale_Items (1:N) -->
                    <path d="M485,335 Q540,335 540,270 Q540,225 600,225" stroke="#95D475" stroke-width="2" fill="none"/>
                    <circle cx="485" cy="335" r="4" fill="#95D475"/>
                    <text x="492" y="332" font-size="10" fill="#95D475">1</text>
                    <text x="580" y="222" font-size="10" fill="#95D475">N</text>
                    <path d="M590,220 L600,225 L590,230" stroke="#95D475" stroke-width="2" fill="none"/>
                    <text x="525" y="280" font-size="9" fill="#7F8C8D" font-style="italic">contains</text>

                    <!-- Products -> Sale_Items (1:N) -->
                    <path d="M200,95 Q400,95 400,180 Q400,225 600,225" stroke="#95D475" stroke-width="2" fill="none"/>
                    <circle cx="200" cy="95" r="4" fill="#95D475"/>
                    <text x="208" y="92" font-size="10" fill="#95D475">1</text>
                    <text x="580" y="232" font-size="10" fill="#95D475">N</text>
                    <path d="M590,230 L600,225 L590,220" stroke="#95D475" stroke-width="2" fill="none"/>
                    <text x="380" y="165" font-size="9" fill="#7F8C8D" font-style="italic">includes</text>

                    <!-- Legend in SVG -->
                    <g transform="translate(280, 450)">
                        <text x="0" y="15" font-size="11" fill="#2C3E50" font-weight="bold">Relationships:</text>
                        <circle cx="110" cy="12" r="3" fill="#95D475"/>
                        <line x1="113" y1="12" x2="140" y2="12" stroke="#95D475" stroke-width="2"/>
                        <text x="145" y="16" font-size="10" fill="#7F8C8D">1</text>
                        <text x="160" y="15" font-size="10" fill="#2C3E50">One</text>
                        <path d="M200,7 L210,12 L200,17" stroke="#95D475" stroke-width="2" fill="none"/>
                        <text x="215" y="16" font-size="10" fill="#7F8C8D">N</text>
                        <text x="230" y="15" font-size="10" fill="#2C3E50">Many</text>
                    </g>
                </svg>
            </div>
            <div class="er-legend">
                <p data-i18n-key="er_diagram.legend_title"><strong>Legend:</strong></p>
                <ul>
                    <li><span class="legend-pk">PK</span> - <span data-i18n-key="er_diagram.legend_pk">Primary Key</span></li>
                    <li><span class="legend-fk">FK</span> - <span data-i18n-key="er_diagram.legend_fk">Foreign Key</span></li>
                    <li><code>||--o{</code> - <span data-i18n-key="er_diagram.legend_one_many">One to Many (optional)</span></li>
                    <li><code>||--|{</code> - <span data-i18n-key="er_diagram.legend_one_many_required">One to Many (required)</span></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- ÂºïÂÖ•JavaScriptÊñá‰ª∂ -->
    <script src="script.js"></script>
</body>

</html>